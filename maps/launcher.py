# Auto-generated one-file launcher
# Payload source: box_esp.zip
# Payload SHA-256: 2855559dab5d0ac6de78c5f1c618b5445cf117890b434e9b2907f8085f3e270e

from __future__ import annotations

import atexit
import base64
import os
import runpy
import shutil
import sys
import tempfile
import traceback
import zipfile
from pathlib import Path

# Embedded payload (zip) as base64
_PAYLOAD_B64 = 'UEsDBBQACAAIAJoIMFwAAAAAAAAAAAAAAAAKACAAYm94X2VzcC5weXV4CwABBAAAAAAEAAAAAFVUDQAHFONpaRTjaWl+22lp3T39c9s4rr93pv8Dz527k7eOmq/mennrnZfmY5u5NkkTd3d2Mhk9xaZjXWVJJ8lx3F7/9weApERSlO1025t9zzNtbBEEQQAEQRCkxnk6ZUEwnpWznAcBi6ZZmpcsTJK0DMsoTYqnTzqdzlUZJqMwThPODq+22W36wI6vLvynT54+2WAHZRkOJ7xgZcr+Z1hs+/yB/w8WXPIije+hIB2PC14WjFoLtx9eANTGaDbNeM68NImjhHexwlEezgtWABExZyUPpxvDNE6BshE2CYhmRZTcsZCVeZgUWZjzpGQXi/flS5be8zwOF0jRJf/XLMr5FAoL5kVJUYZxzOZROWFZlHX3nz5h8IGvTJURCqo6S1g5iYDSCCigKheLcpImbIfBf79GySgFCucTLEZOAGg+SxKgyidGIRLJw7SovhaL+nsZTXn1459FmlQ/huUi41qlMp8Ny7reJOfhCBqqnszyOI5u/Ry6ywsAJO4KJEqO8yih3z12u8j5WMIYIFfE7bNwyoGhQ16DIKclzFE0LHvsIFn02NuogK+DGdTpsfMMVSSMsdcjPgZuBOFoGiVel238BCJLY8nsMl/Ib/jJOWhbIkn1gcZRHPvFhMfxzrZ/WnwoeH6QHEhEf+qzTVGVPwx5VrJj+gPtNjGehHHBkRhBTs7jcJYMJ0FY0aWEH+bhtGB91mEd/58plIz/2vkc5ndfOn9l4zRn8BW0AwXnw9f7rqjmpvgK/x4/8OGs5L96NVFnMFx69c8OKEpYdLQniJ1TvfA21kEFeb1WVFvyuyRL4IlKb7OLXX/GNr7dB9G9DotoiMq/s81esCxPh7woGPQaxm/xzdt7+gT7M0qTMpjnUcmD20XJh+mIg7gG+Qzkm0J3k/soTxMfzApIOpzFpde5+G3w5vzs6Pxs8Ovl6eD49W+D48Pzo+NOj3W2OsSZjzxPOIgMMElRQqeO3r71OqoEgGcFD+KwKAOe52nexyap8uDNzvbhVXB1dnBxcXl+eHx1BWg2HzbFZ9sAeHd+9OHtsV7+6umT07NfDt6eHgVvDs6O3h4H8OPDcU3JMLhPo1GQeRtbXf8+jGekyLKl4P2H48vfgtOzk/PLdweD0/MzgXt3c7OG+eVdcHl8cCRb3dJKLo4v351eXUE1pLkd57+ZhUuMpSGwo1BFx2eDy992tj1J9hVZKTDRamgF44jHoyKAhq5rjfU6o/lV9IkDf5VN8o9+Pb886vZ0oGFSfijCu1Vg5WRn+0Ko4enRGrBHQkXe8DAjeEn7xfnp2eD40qskMIMZ7q7brP8uHc1ivrIpoH5AVrpYh36avdbtRTa8yKNDlAMMRl53YRgQyT2T0ydxeLeKhuITmKwTmMd0ZMNJmLMf2PbepgK+0VVAqPV31YBHsPsxWvBzfBuvqVyIck3QaTpCcRyMRvkSrUL71XVWXIMfE8EMHeqNEIMtzgqwIc2Xew7RX4Tl5BGi/4UPd9aSuNd50NGO4zQsuz1odeF+/Kn5WDb8zeexMx4OmbD0bJRH4DGy52yWRED9iE35NM0XMOmXPB+TI/TN5zU5iKihSzATPJf8A8cRnZ6NKc5ylxfvWE6lbAzO6W04/OhLzxJh0bEJgiiJyiDwCh6Pe+DKjvaR8K7mET1jgJEV4NYxmKWnUVGgM89C8NInHPAX4KCOha9bDPMoKzW3BJD6E3D4Y5xy1czon2c8kcPNc0wsPeF9ETXdGlk0ZrCU0HFqROInDyMgFBxvdIyPccr1xh2tLWACGKkReWWAuv8Z/vvSYzA59z9LvbnjpTZje90vYrZX3BrGacGJVeSWoi+1bxDYTlzV+UPE8YZAPA28a4KbnMOGdDpQqFJiIVgM6BtJrQcLnk+8IUDJOAnJoPcIxn6E2d3moHB+RXPq4e1sDCRoUxtaIRjfiKTrdXXXORwFhFpzRfB3IPxJBZd+1JUB1VcKSOizzpVew6eRvYABD3SJDldAtDLxKjK6TeWBpqH7FYTwjlh/TU7Ih9j/woPmr/ctTDddYW/shRYOlkBbdgWi94E0HUrA5mOYj4fIqbqi/xaeIMctQBrCYVnyaVaCfvft1YsASMBmyRrV6gWswdvw02IDjOUIluojNkyThA9LXICjjTsE3zlP4xiIlLSmyZDsgHLehUFBXHdxehvGzKStx5bSKmrS6tjReVOHLaaBuUGJWmNQE5MJvwSVRdM6mrBKAGJ1oaDNNSuNKZiyg1GEooclSAYTqA+/ErCxnvod3hb41wsCjCAEQdeyEMNKNAHCaZhoFapagCWLKciNaRglncbjjoUeuKTwRQXg8az2ukpdDCJQInKxi7+tXuNHFflRAvMUGIaejcQmRIwl0t4aEqclHPRg7O6SNK+so/pM75C3ViUfu3xEInsXJuCU5V6z19gFqO0XZZiX9nhZqRgWEjmcnPWbWqERD82nWdV6E2xJBEP/ZOAmPILyhl0CSkyILIfJxetc/4MAb1qMBPGOGxaFj3xbxVaMU7uLaETtoS7IGdf0nIgpHswXjskojHE6chK5zz7zLy0kqflWOVoCu9vdGkxA4ed5mKFRxNih3Ry6Gxjgo+XcV/hfNB1CAYgD/reeV5Jy2Hi9nagIYIaKRrXzosXUtJ7rSDUL+7udDx0v8OP3+CPNcTMKyxBYoLXh08Qsp6hgqvkVwMIe0qg5EvjL9hc00hH7Y4a/4SVg5W67Tu8vVT+d48Fsb9fBdRIl/NUQ6dwgWUn4HnvVdIgIGCQQ80TQyn5kr9xUbTaUBdr1McYb1H293n91A3NLHJUlrSALMM981CeHpNvsE6z9f2efdtfr0+7v6tPuY/q0tfd7+7S9Xp+2f1efth/Rp3G7nGid/Z+QlN/sl9jX8GdJBitbr/PjGDqiBNa93rxp9OMeQw8tHaGNiGvqTo/pf27W6t3WmkLbapGaBx3sMfVfd3Vfx3Vvt7bVwkOPC5yq+IMWGjAjFFAIcxksU8ISZlI+5nkh12UifnA7K9kwTCh4wB4RPehJLAFPcDsCHuJkI93iXhWLCMo0mIETiG0ZIGvPfmYz1apSPbCgXe1CHddj3Z2kujWduhfA/k22ulrAOYjbdzgPS6sFw1lOu5HuUtnDcFjCPKcv9UwwkouI/RSmJ2AWrYplWIJ0BClkFKzv6Gc14zYnVq2qX/kmLi/Z5olWsQ3YZpG5GFMf5ckCwTfsA+0G67ovGGT4rIrsihpwkEiO6Oa2apjVJ7fXb+gYkLwOF1u5UyvxevyRKrQGg2ZGaLGOKVqUreO51y2MqyYUcmOsoLrKyF3DZW+TyOrAYMe5UAiThbKNMm7qSfV+Xve9639NULBFHYwyX6DqLgFxBANh+EiJIoAU61p+vqkJCucz9jadb8T8HrqNXGBfG6ZWBEpjI0hqI0VK8OsXGrlSf9Vccz7O11lePHMZbBzhxoPbtJyAnmcgL0aeQKNbueUg0Aqj5vFgkYH6yZ3vr90e+NolwtfzatMAnIRFWJa5h1EmRUGn664p12RIo1p62UGc6yTdgCG4IWrc/P9e0nw/Gexsr5IB0PgNZfCHW4I9YrnyO6Tgr5DDeKUcxn8oOfwhFlhfL4/WBZRLNkjnCuFQV76hdP4IC0RDVtOwzKOH3YfdtQTm+/56C+G9NdVwb3dJP7vsB7a1t6qP4w6BqV7u7apl8DP2s9iMsrfi0YsbsduFnHjZeJYMKTeV3fI4nT998u743b69fraXa1WOIi6kRAtB1YJXhXAtZ1Buj0ED4re5EIDHldt/quOy19L99jW0SjBDfKtccNP1djrDdhTBdr4FyTVLvnmSxRtbRjnHNL6SJ0gp9LohKMzCRY81BRUP57hI+Q65F9UAEtNTIHaqg1mCuiU9VBwNDWeVvHGs06IRMFiQp2pVqYXJ22LkKtSstmDlqAQs9aCsPE9rPC5BE+GigjKaE1BCBO4Jwh3eO5a6FLotCr469fZWxJg0RqOqyqQKi72WXyX7r0lHpREITijT5DYnkbSXOLMhDwgbev612fqpz3YZB6cD3RaDRvRr16JxudSb7Ng0SFairfzobk1HEY558DhitNQQ1DH6+xPbfPjbyclJcKL+ayXKKXKLAtH42tK3+UrT8JK+YDbZmtKvZuB1Z19JEiWsuWZfZ/cRWrqvs/GY58EwzRaePg+vxwhnqwZrxAS+jDltM/hjdbAxJ9vaWPsSlk7Otwtvut8kpMeyfepij80l6ZOabjwlcA2j03IQH3BHGgfnDyzzH9hz+LElfizox7b48Yl+7EivbEGVdvVKL/VKe3qlv8lKn6jS1rbR1I5ebWtXr7f18qbi5CdQo01/S+eiI/50yycR7o6HU56HalqNkntoeMvfZC/YJ4PTn2tsnYfOPpsDxDbAPQem/ED1flDP9IMCCwCdSNANYIUCnRigX77TBH5Oh3UYJhdhKM08rtP9DlPz+cnJ1fHgKvhw+RZPZEzKMiv2X7wAX8C/i8rJ7BZdJcwH4bDEHKbTFyZJL3I+Ll5McJ/+BWbJvEhnZTYrX8hDRz6esYG56fDt6fHZIDh6+/ZbNzSMI6gQ4JEQ2dabweAiGJy+Oz7/MAiujg/Pz44w8X7rpZbdNeblcBJgBW+Wx/s4rVmj6CBZqDGU839BffPAj38p/monTgBA06OJ2C3ofzY9dpFqenAHNIOedQ6vtjdepw8bx1cXkmVgFyjNRj+qQhUPhmj3sFKYZXE0pANiL6jPGugX7fuUl5N01O/8fDzomGdWKHvM6hD8TDMw6/C7R+ekgMF9Fy+76BjnzYWNjN6Z/gLS56M2C4/GH9FhEq8zK8cbrzqUSZoCl2CJmcXgjna60hAGUoGCIZ5u27cPSrWtLzAZVdb0xmk+BB8zg3brvTIR/kBRWxhNM282X9kp87Ge7UFOD/4wWm3MCjZeAaAeIrMwL0XTTm14qmNQQuEdsOYgq1av4zgs9zXNhhnjBmp+/lJHVjEdvjon6I3mx2B2y4U4bTaa/xLx+TuarUBe5dCXhGCSzpTS3jF/Te+DyOwsPCupRXOQRT1ADlTZMQXE+7HH7hGrgPOjkk8L516Xifa+Z4e4DcTAiOuP2Pf7uuvvwo+cFbOcazl1sjPgcQAHikr6ndH8bToM44s4XPBcywNUOXzEaaPLZpWLcJ50HIAVca0tINEOCEKohVLQzX403s2aGSdxSGvF2qgysT0ujhgwbxpEb3gYl5Meg68DHk7PZtMlWqEpq0spCDnHo4BS0DB+vY58Ctbh85cuepuoqrp2EECAqZ89+Z1MELVHVVsURvYCM7PrWoS/K1oWAO6GpURpjBOYQ8tQhaLE3jpFkqkKKDUlT6MGEIoliv2MXWV8GIXxxhAH5+HVRx7zMk1Opa7v709p8yq+KsHSoEGbBtlrsEQHeY4ncW18QDq1iZnbHb1qR6QcViwlgEZznbYxJXAiyrr1jhtWZo5T8hh974IvtrX9auWoRtjVI5tIodGtzu9hkWWy+7bd9374AWubs1bTTIOjJM1jv3WS0WLrz9ivYFCTeMESjkmd5A5AD0b8gdSBDlT/FzSHIRk8E0JnRUQ5zK4/X9GpEP/pk9fnZ8fBxfnV6UCeH/zcQVTgBux9LxcUEy/VMdPnjNNUwCQjvrn7qfJvoFF5okGtTB25MgBAKkr+mukC9NCCtBdKf4aWS/BwZ7OZLyMTH8UQYF7VGNqBjjxY3+n6PCEHpmtVF/arqq2IEZXJCPpgTdvrz0PoqKQSEMhvLTRqy9eleTEKXoZXl8LKDmAOvBNYkwrqf6bnxdbgOleTMNMPrRyCd1jyAbhhGEje2b6C8mKSll7zaC8s3a2MBcLVZ65DvOtsUAP780V9+FadoexaEL44JFmfxcEwYDr2zGrNWH3VR6nCO9snUQ5rAyRbHv73qIGubcDcR5ygWneNXomLEDCCvd+YpkR/qmOmyLyGmrvSSyhrTFQ2Tng2QdclXSPfyEZbyr8z/rAO+/BzC3r1sX68DlktOcOk2No4+A4KLg6P9uzh+W21HbqAEW3juHDXKG5TdKPOEj0Xp11dag7I/3NKjj1RR28rDdcssUtb0Jmqz9qFQD5i0c4SN87PVRcC2Li+YgRg88uHgGJtYwS4OEs9+mb6X29ktaZm0SkVOT/5+J+uWEJUWhHbkBV+bE5yrqSuekBUW9pqrmlJh9RmuCZnHHNm25Fat1u57KCt1XwTQdfp1rrmcXfj9qxssES3Ul13fdWYPrG7IfEjVMIsJ0kWMeeZt+m/1PWHgrMDIUgZnNW9RlqiKZ9HRkVmyahjZFyLGEOdaP02upuUc47/s/uIz3FHMhTOKK1alSdKsStyR/FeooQb54MC8pevBpenR3i7x8629vj1h5NgMMDg46aPN4a0+pl1IECG2TNYZquIe+16NVzISsXEF6tUCy/0tSZslw2awrxt+NPIUJ5krK/n/tBDvKjJ8ThLcaXSug1T44TFhNhVcDt8+EnSuRryGc/HwRCEWZp5JoSLToEXnCfBOBd+8MaWzQSSW3t5kIDZC7BPAdi8nBd4SDPBLAMLECXf7qyaOAXsbLwvtlbXAw6mUeLgq1YePjh7UAHwhywir5PShGptK9PZcCJVjRgRtKQ/LGGsqqfjFYtQ5FvxSEVua/c7KbRMcCXxBpUgV3lbQw6AicjnNbdtNVp7WqPP5WZK4U+D7Gfg1xWiOMN05IZnU2N3zUsVjQ2dwY/TbWnUW0Zy3TWD5iqe4shcMtA38pQwsOXSsB6OpX2xQ2gOg2V52OagrZXP6YsuH/C13hoCmLdkoS+xPDUgZr1gSLJ+0jwwUNvPKjtiDa2Rsc71DyM6zXR1x0XWfl7T7M9FWkSIfWWPhJU30whX9On+PB6d59FdlDyyW0tmFJ12jAkzD4ROnusMb9KLwAkI0ZdmRRZOp+ISwduo7Da04Kd+2zRgUbTkSIicEB8lZxnIXnEmY0WLmw6mtc1nGPisZwXBuTcYIsQxzTwZItTTkPBj2BOZ8WlbUZOp9TRpEkeOk8KCDiUBZlLvCu+zGXe8FkHHmy9kQPrwz3XggmKcfemUYTzdjUTXu+Z+hY7JXqA4CBVGLkpG0RAvWlxq3mgLjKyg5u/c7P9+W6RAKMLobgUjt6iNUXdf0IUijnAnQNL+pTEnNRdJ0vgbgUH9sHitH2o3slVLlmDWcI8eUEmuBeE1yQDmf+SLAlZ4GKkXpTB2N28adCGKNXpxK7wtvCUSa+g6L/ws+F+VaI4ph6kl4SgXzzX4lCumJGrCULKgZnMsx60BTDT+6HATHZBA808Oh7GGtGyf7Ig9FkSMxiN8G4IAMByYVSRwa6sda3zjVSaUmta3VeO5wLMaBd1hpGWGGYa0aqBnGynVJRA+opDJYvCVbhOl1M6mHXXpBHHAlGMfUS6DkF77bUMqTuf91hCJA6xy4YXJrjkm15K6Mgr6TASaM1Tm0ai2206uE09FB5YpmWMYNkNjEWhqhY8quPRx7S3MdEwXWkWohRIraSH1ap2p+aHHFj3KETMySAPM+vM6IvGebqeClhwBDejqdXSj/A8y8N5DV+a6eYvq26fu4+fwCrfz5ippEp8+CY7PBqeD34LDg8M3x7qZF4EMlVKhwE4uD94dq931OjmFghhRlWcpvfJqIUvzFOZdXEusVlqKTkOPGW1VIRCDgOd9JleoyvXGpBGzHpau9LRNscaYTRAYK0BXKq3omeZrteQhmBsx0O8gBh6sj7TOV1k7V/S6OokDU+MsholbZzvOehVANeDyMLnj3laP7b2EaRxctoJu5s5HbG93Q0apbmcjkPMyzx27FqgdKbODTeVUXdbZ8px5r2DweTAc/yITj2H6/Yn9nfbT96wR4DbNNRFLbYBZtoa8tc4BLVvbSKcgcwuodNOiJ97kRiP9hqI9glp08+uwr5tcrTF9QTCp02vcJGu4H0vRN5G83rev1oGanEf2oZWdWgcr6duktusBRafWp0Qc3zdMIq06MqfU2o+617jE4NeubRM9UsEyx7xktH6NwDdi/9QiNS5aWvX1qN2Shhtd90UYUVn1bhOgjgQpoLbVm2BPS4ACP26nQBhOH6/xSka4Q7t+RMGW6TN2wfMohZUQG8Y8TGYZhv/x/QCcqSlTQGIek5rJ/sz2Nu2bKKlOcMvBaOsBJ3BcdjY3TSeKNFP4sKQdCVkvz9QomaHlcLFA1+iEJMcZvGPFaMGd2djC0xE6PfsrFMjP0szTqKKVaz1NyaMiyPTvlPrzLkqiaRibb3VgdDHiCF/BIPOS2PvyXJR9j4z02h7RyxCIFv99eYgClTcbvgeOv7/kw9IB9/MsqsAuQjpkCMCHaZzi3wsOo+r963xWTOAvwB7UydQOZL9GOJtXr2t4r0FDdVH69In75CBqdZaHd9NwH8YdqDxe5LYhUW2gq0V3dMxyOax05NIbbV7ZSIAm2cthBY0Ak97+E28pdUIFUtSBIE5c5YuGDPpWm642KBWmCYSXGvwLLMK+2R1ry0WHVHe2Nq9sVX4zTzA/l4DFuy101JaDrCEWBeKiVLs9M+ijF69xSWqjDYnG6PHa16o0bUJHDD98u4l4mYq4fxnTBNWQxMCqJFS+RgXPUf45d2Re/pl5TsH12n0EZEPf6I5fJWOagQvJMEdPmzg89T4P9PKuMaUO1qIPijYjLmgIpE+47NPkYYEXGuBrZm4avr0LXhRtiDuH9X3oQJoyMVA8OWC67WmI6TzBDbVOZQQ7mF9YxiLz0NgVnmW4hPIrBPaOaUC4cHDiX6sQfFHxypsBIveoCconxD3x1+IlQJ1uWyV6C4GlXO9L/wQnp5gXhYB6I/baoED8virDRXGeDNKsLsGMphqPo8EDmAUj0EjuIZ6DYIDvB4pnQ5DNa1jj3+W4+d9j2lHrZbXP0qtFAZPukqotuyFtpIhXFZ2k+bt0VvDje3w1UQPnCofFvBW2nYCa+V7FVJOI0ySblV/XvMa8YQ6uBg4wcy7wsxwm8HxxReXWYJWV2g3cHU/RtScwcKXTKYeOOu9WEorrz6MRXaMMsOL7MuCJyO0Q0OKHExy4+LNqG0DX2C6wqNn6+/bmGmRsbb7aXNE87nD1mm30HAi7jRSFYpLOmyMefGV1polCSKV4mRM6JiqEZFa4RV/FWYW8GPMoD5qrDJ0e0nJpsDh+FwELwySi5cX4nWZAUX0ivNmq2hySnQwKmc0Y1CCOi0bqwhWbw5nwzFCDpZMm9v8NjMrD1ggBTxtfERQmlKkW4hVrHZmT1W2MGcKLAr2EBQrP0aR5qjn/QEPRHI5NTXsUOnUSYM3KA/5QOumxFizAXVymtHL5I56P7VP5tb4ZI/kpivt4ocuwdJ3oCHoyUDuHpSdGR8hpHkexuCoS8TYrAQQQfNtjIeWBQJUmDJ0+iZvXITr4AwMBTedZCl9aUtvEkPjIMYzi1c0vg65j6vVwomhBhas9jU4gaA8e2A2JgemJNYdOX7e9boO464owHOH0YyXrRLsE62iqJQhBOMAoNdjZY1vdVvCKn5U9E7EXgaidlxlP1uCkaOA9qcJjuAj1xCSMU9HWSnZXtF9LupHV8HUtHc1a1bMhEVLn1y1iUdCjPJzjktajha2H9uFB3rS9kH/n8u+k2zVsg0KBYRgjx7JyUdu82UYOI81v6piMOZHKnXmc7CoAYwolgHFWVKW7u1ahbbrNY7mNGTQQPm/fdHltoDk57PuWI788y4+iNSopybjGS2pGbWHFvgDNuWpbwMLVtn41wSbzZLTkZM1/Z3kKq4VyUUsKa6zIiqtu80TY1UvXGrYunldDeR6ZWxeAvC0ZYs1b5jXaxLG/Ob6+8RS09JHJRwqHc4tO71XNPdRy6QDVqzNbl1pTHyvVo7/20tiISNSFIx4zOyigs7aFmQZI316Qal3oGhmUNNXiZVb53W1YZXzCM+0eE9pdNP7T812aApNmtjmRr7qFH916nKfg3/bLlw0RoeyBrr9gobBhd8av2+oX1dZ6meEsiMOxOgQYTfcZDUeX8CjcU49LJ6frwa1i1/jEZK7L3a2GomYR1m4a8aBTTSFmm47uCjIxJt54p4k6VIWIddpv+V2UBJRU2nqlrVJMtNYm1jXSnPAzhSZGZOTp5hWx+65QWrAEh3g3Gta34aKO8LCIQO7wD7QTCZKADajh5J5h4VdkkK43TJfkHFa2RtqNxych2O/QtZ6L+7hrGYPS2hJumxmW9slelrWZcIFEblbZurDUJkoAdeZFRF+8r4t8PKN3VGP+qLZO/Yo9BsVFdLkwBilNy8O+umNzUX2bV98m1bfayNpXP4EhrmZT0zyLOg03ozJunliTqTwWV27LvPo2gW+IVa0zDdNFnRKLrQBx/t/tHK2Bu99pq0t6AAzvEmJxmmbf5XA7CgRb8GyODgt8D3J96l2NCDxorp3Dk0+rLAYsNk+PCQB1rBGKtfNeokyc6dVrqvx7FbQBAHlzopUqbCanP2OnkjJorO3Nndr17+rCTdmJ1rs/uxU1y25Uqy7LkVsg/Xp1o9gki4Q5tsPkqg9X8gX36d1drDaVMVQX4CxVv/eAHg3rZ6o6LUdltcPzt+eXwQCXzeS77O1qd7mKwkMqxYKtvU3ybozi88Gb48uqvvqvolacqFTd0if27lI3Ttwtp9I3jUvvHNlT9f0+lt3GKBBuTsj2ZexT/RRLQWumk3v1rO/KdhNtN7IZMLQlN+BVBccMaSYpMFGHTiUsjye0pY9oOEUCP3iudd40KcRKjCvw7Zj4huVXkChT4anrxp35WpvicpGlXHhWv5EGb4JN6QTIhtjYx5MGuNbjbJQmfy3B2txzeUJgwUs3PkkWpWNKOfgPPSUSf1F/xdv+9natcyLq0/5CvzHn5TY2QdchqtunBE4Rn+y2U9aoiA9ba635YsBlUsKNTBwqniD7urPo3IBvKmihX3QVpL/pvuxGVAe93nq0ymFV9NgFCrqisAmEpkDR8kCUiWot4AsNfFGBT6AHm9SD1QOptRsY7JFm0yGI2B5Aa+A5dCIq+BpVyfq6uqNMXOUgiqg4MU38EdFxQ6elGv2DL27TMB/RFcv5LLMHvXVef4Xy4XuzMW8kBhc+ZBgzgwnhFsaeWNp8xLNVWmJAu++sd6tePUjvCnMg6MaEIKD9gSBApyUI1B6BOsxRBOEIz2jos496582fbtgBFsL6Ng9LsVtxD9PXHa/zGHwmr01EH57H/F5sWvrG63ByHoezZDgJwqo5fCwATIMhXCvxe9X13dracQes0dMn/wtQSwcI1/Mt5MwgAAB+hwAAUEsBAhQDFAAIAAgAmggwXNfzLeTMIAAAfocAAAoAGAAAAAAAAAAAALaBAAAAAGJveF9lc3AucHl1eAsAAQQAAAAABAAAAABVVAUAARTjaWlQSwUGAAAAAAEAAQBQAAAAJCEAAAAA'
_PAYLOAD_SHA256 = '2855559dab5d0ac6de78c5f1c618b5445cf117890b434e9b2907f8085f3e270e'

# Entry script inside the payload (relative to extracted root)
_ENTRY_REL = 'box_esp.py'


def _cleanup_dir(p: Path) -> None:
    try:
        shutil.rmtree(p, ignore_errors=True)
    except Exception:
        # Best-effort cleanup; ignore errors
        pass


def _materialize_payload() -> Path:
    """Decode embedded zip, extract it to a temp directory, return the root path."""
    raw = base64.b64decode(_PAYLOAD_B64)

    import hashlib as _hashlib  # local import to avoid polluting global namespace
    got = _hashlib.sha256(raw).hexdigest()
    if got.lower() != _PAYLOAD_SHA256.lower():
        raise RuntimeError(
            f"Payload hash mismatch: expected {_PAYLOAD_SHA256}, got {got}"
        )

    tmpdir = Path(tempfile.mkdtemp(prefix="gscript_payload_"))
    atexit.register(_cleanup_dir, tmpdir)

    zpath = tmpdir / "payload.zip"
    zpath.write_bytes(raw)

    with zipfile.ZipFile(zpath, "r") as zf:
        zf.extractall(tmpdir)

    return tmpdir


def main() -> int:
    try:
        root = _materialize_payload()

        # Ensure imports work for packages/modules inside the extracted payload.
        sys.path.insert(0, str(root))
        os.chdir(str(root))

        entry = root / _ENTRY_REL
        if not entry.exists():
            raise FileNotFoundError(
                f"Entry script not found in payload: {_ENTRY_REL}"
            )

        # Run the entry script as __main__
        runpy.run_path(str(entry), run_name="__main__")
        return 0

    except SystemExit as e:
        code = e.code
        return int(code) if isinstance(code, int) else 0

    except Exception as e:
        print("\n[LAUNCHER] FATAL ERROR:")
        print(e)
        print("\nFull traceback:")
        traceback.print_exc()

        try:
            with open("launcher_error.log", "w", encoding="utf-8") as f:
                f.write("Launcher crashed with error:\n")
                f.write(str(e) + "\n\n")
                traceback.print_exc(file=f)
            print("\n[LAUNCHER] Error details written to launcher_error.log")
        except Exception:
            pass

        return 1


if __name__ == "__main__":
    raise SystemExit(main())
